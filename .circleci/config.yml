version: 2.1

jobs:
  run-migrations:
     docker:
             - image: circleci/node:13.8.0 
     steps:
     - checkout
     - restore_cache:
         keys: [backend-cache]
     - run:
         name: run database migrations
         command: |
            cd backend
            npm install
            npm run migrations > migration_dump.txt
workflows:
  default:
    jobs:
      - run-migrations
